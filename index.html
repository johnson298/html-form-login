<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<h1 style="margin-bottom: 50px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis, tempora!</h1>
<div id="qa-login-plugin" style="display: none;">
    <div class="form-body">
        <h2 id="f-title">Create a free account, or log in.</h2>
        <div id="f-sub-title">Gain access to limited free articles, news alerts, select newsletters, podcasts and some daily games.</div>
        <form id="form-action-login">
            <div class="form-item">
                <label for="form_email">Email Address</label>
                <div id="qa-form-email" class="form-input">
                    <input id="form_email" type="email" required>
                    <button id="qa-edit-email" type="button" class="f-edit" style="display: none;">Edit</button>
                </div>
            </div>
            <div class="form-item" id="qa-password" style="display: none;">
                <label for="form_password">Password</label>
                <div class="form-input">
                    <input id="form_password" type="password">
                    <button type="button" class="f-edit">Show</button>
                </div>
            </div>
            <div class="form-item" id="qa-birthday" style="display: none;">
                <label for="form_date">Birthday</label>
                <input id="form_date" type="text">
            </div>
            <div class="forgot-pass">
                <a href="">Forgot your password?</a>
            </div>
            <button id="qa-check-email" type="button" class="form-submit">Continue <span class="btn-ring" style="display: block;"></span></button>
            <button id="qa-submit" class="form-submit" type="submit" style="display: none;">Log In <span class="btn-ring" style="display: block;"></span></button>

            <div class="des">This site is protected by reCAPTCHA and the Google <a href="">Privacy Policy</a> and <a href="">Terms of Service</a> apply.</div>
        </form>
    </div>

</div>

<script>
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }

    function getCookie(name) {
        let nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    const $showBtn = document.querySelector("#qa-password .f-edit");
    const $inputPassword = document.getElementById("form_password");
    const $inputDate = document.getElementById("form_date");
    const $inputEmail = document.getElementById("form_email");

    const $loginAction = document.getElementById('qa-login-plugin')
    const form = document.getElementById("form-action-login");
    const $qaCheckEmailBtn = document.getElementById("qa-check-email");
    const $formPassword = document.getElementById("qa-password");
    const $formBirthday = document.getElementById("qa-birthday");
    const $editEmail = document.getElementById("qa-edit-email");
    const $qaFormEmail = document.getElementById("qa-form-email");
    const $btnSubmit = document.getElementById("qa-submit");
    const $subTitle = document.getElementById("f-sub-title");

    function checkValue(str, max) {
        if (str.charAt(0) !== '0' || str === '00') {
            var num = parseInt(str);
            if (isNaN(num) || num <= 0 || num > max) num = 1;
            str = num > parseInt(max.toString().charAt(0)) && num.toString().length === 1 ? '0' + num : num.toString();
        }

        return str
    }

    $inputDate.addEventListener('input', function (e) {
        this.type = 'text'
        var input = this.value
        if (/\D\/$/.test(input)) input = input.substr(0, input.length - 3);
        var values = input.split('/').map(function (v) {
            return v.replace(/\D/g, '')
        });
        if (values[0]) values[0] = checkValue(values[0], 12);
        if (values[1]) values[1] = checkValue(values[1], 31);
        var output = values.map(function (v, i) {
            return v.length === 2 && i < 2 ? v + ' / ' : v;
        });
        this.value = output.join('').substr(0, 14);
    });

    $inputDate.addEventListener('blur', function (e) {
        this.type = 'text';
        var input = this.value;
        var values = input.split('/').map(function (v, i) {
            return v.replace(/\D/g, '')
        });
        var output = '';

        if (values.length === 3) {
            var year = values[2].length !== 4 ? parseInt(values[2]) + 2000 : parseInt(values[2]);
            var month = parseInt(values[0]) - 1;
            var day = parseInt(values[1]);
            var d = new Date(year, month, day);
            if (!isNaN(d)) {
                document.getElementById('result').innerText = d.toString();
                var dates = [d.getMonth() + 1, d.getDate(), d.getFullYear()];
                output = dates.map(function (v) {
                    v = v.toString();
                    return v.length === 1 ? '0' + v : v;
                }).join(' / ');
            }

        }

        this.value = output;
    });

    $showBtn.onclick = () => {
        if ($inputPassword.type === "password") {
            $inputPassword.type = "text";
            $showBtn.textContent = 'Hide'
        } else {
            $inputPassword.type = "password";
            $showBtn.textContent = 'Show'
        }
    }


    const showHideStep2 = (status) => {
        $formPassword.style.display = status
        $formBirthday.style.display = status
        if (status === 'block') {
            $inputEmail.setAttribute('disabled', 'true')
            $editEmail.style.display = 'block'
            $qaFormEmail.classList.add('isDisabled')
            $btnSubmit.style.display = 'flex'
            $qaCheckEmailBtn.style.display = 'none'
            $subTitle.style.display = 'none'
            $inputPassword.setAttribute('required', 'true')
            $inputDate.setAttribute('required', 'true')
        } else {
            $inputEmail.removeAttribute('disabled')
            $editEmail.style.display = 'none'
            $qaFormEmail.classList.remove('isDisabled')
            $btnSubmit.style.display = 'none'
            $qaCheckEmailBtn.style.display = 'flex'
            $subTitle.style.display = 'block'
            $inputPassword.removeAttribute('required')
            $inputDate.removeAttribute('required')
        }
    }

    $qaCheckEmailBtn.onclick = () => {
        const validate = form.reportValidity()
        if (validate) {
            showHideStep2('block')
        }
    }
    $editEmail.onclick = () => {
        showHideStep2('none')
    }

    form.addEventListener("submit", (e) => {
        e.preventDefault()
        setCookie('login_form_time', 'true')
    });

    addEventListener("load", (event) => {
        const isLogin = getCookie('login_form_time')
        if (isLogin === 'true') {
            $loginAction.style.display = 'none'
            document.body.classList.remove('modal-open-login-plugin')
        } else {
            $loginAction.style.display = 'block'
            document.body.classList.add('modal-open-login-plugin')
        }
    });
</script>
</body>
</html>
